# App Page Studio

一个用于将设计稿 HTML 转换为 AI 开发提示词的工具，帮助快速还原 Flutter、React Native 和 UniApp 页面。

## ✨ 功能特性

- **HTML 预览** - 在模拟手机框架中实时预览设计稿 HTML
- **多平台支持** - 支持 Flutter、React Native、UniApp 三种平台，生成对应的代码提示
- **多状态管理** - 将多个 HTML 文件分组为同一页面的不同状态（默认、加载中、空数据等）
- **元素选择器** - 类似浏览器 DevTools 的元素选择功能，定义交互行为和图片替换
- **交互配置** - 为元素添加点击、滑动等交互行为描述
- **图片替换** - 标记需要替换为图片的元素，自动生成图片资源引用提示
- **智能分析** - 自动提取页面结构、颜色、可交互元素
- **元素回选** - 点击已配置的交互/图片项，自动在预览中高亮对应元素
- **提示词生成** - 生成结构化的 AI 提示词，用于 Cursor 等工具还原页面
- **图片提取** - 自动从 HTML 中提取图片资源到项目目录
- **多项目管理** - 支持多个项目快速切换
- **实时热更新** - 文件变更自动刷新预览

## 🚀 快速开始

### 安装依赖

```bash
npm install
```

### 启动服务

```bash
# 开发模式（自动打开浏览器）
npm run dev

# 或普通模式
npm start
```

访问 http://localhost:3000

## 📖 使用流程

### 1. 创建/选择项目
- 点击顶部项目选择器
- 创建新项目或选择现有项目
- 上传包含 HTML 设计稿的 ZIP 文件

### 2. 扫描 HTML 文件
- 点击"扫描 HTML"按钮
- 系统自动读取项目中的 HTML 文件
- 文件列表显示在左侧

### 3. 配置页面分组
- 选择多个相关文件（如：默认状态、加载中、空数据）
- 点击"创建分组"
- 填写分组信息：
  - **名称**：如 "首页"
  - **描述**：页面功能说明
  - **路由**：App 中的路由路径（如 `/home`）
  - **源码路径**：各平台对应的源码路径
    - Flutter: `lib/pages/home_page.dart`
    - React Native: `app/home.tsx`
    - UniApp: `pages/home/home.vue`

### 4. 配置单个文件
- 点击文件进入详情面板
- 填写：
  - **状态名称**：如 "默认状态"、"加载中"
  - **描述**：当前状态的说明
  - **分组**：选择所属的页面分组

### 5. 配置交互行为
- 点击"选择元素"按钮
- 在预览中点击要配置的元素
- 选择"添加交互"
- 填写交互描述（如："跳转到详情页"）

### 6. 配置图片替换
- 点击"选择元素"按钮
- 在预览中点击要替换的元素
- 选择"替换为图片"
- 填写：
  - **元素选择器**：自动填充
  - **图片路径**：如 `assets/banner.png`
  - **描述**：图片用途说明（可选）

### 7. 生成提示词
- 选择目标平台（Flutter / React Native / UniApp）
- 点击"生成提示词"
- 复制提示词到 AI 工具（如 Cursor）

## 📁 项目结构

```
your-project/
├── html/                    # 设计稿 HTML 文件（从 ZIP 解压）
│   ├── home_default.html
│   ├── home_loading.html
│   └── ...
├── pages.json               # 页面配置（自动生成）
└── assets/images/           # 提取的图片资源
```

## 🎯 核心功能详解

### 元素选择器
点击"选择元素"后，在预览中：
- **点击元素** → 弹出菜单选择操作
- **添加交互** → 定义点击、滑动等行为
- **替换为图片** → 标记需要替换为图片的区域

### 元素回选高亮
- 点击交互列表或图片替换列表中的**选择器标签**
- 预览区域自动滚动并高亮对应元素
- 高亮效果：绿色边框 + 脉冲动画，3秒后自动消失

### 多平台支持
| 平台 | 语言 | 布局组件 | 状态管理 | 路由 | 图片路径 |
|------|------|----------|----------|------|----------|
| Flutter | Dart | Column, Row, Stack | GetX | GetX 路由 | `Image.asset('assets/images/xxx.png')` |
| React Native | TypeScript | View, ScrollView | Zustand | Expo Router | `require('@/assets/images/xxx.png')` |
| UniApp | Vue 3 + TS | view, scroll-view | Pinia | uni-app 路由 | `'/static/images/xxx.png'` |

### 图片替换说明
在生成的提示词中，图片替换会显示为：
```
- 图片替换:
  - `.banner-img` → 替换为图片 `assets/banner.png` (首页轮播图)
```

AI 会根据提示词：
1. 忽略 HTML 中的原始内容
2. 在指定位置使用图片组件
3. 自动复制图片到项目资源目录

## 🔧 技术栈

- **后端**: Node.js + Express + SQLite
- **前端**: 原生 HTML/CSS/JS (无框架依赖)
- **HTML 解析**: Cheerio
- **文件处理**: Multer + ADM-Zip
- **热更新**: WebSocket + Chokidar
- **数据库**: better-sqlite3

## 📝 提示词示例

生成的提示词包含：
1. **目标平台信息** - 框架、语言、组件、状态管理、路由
2. **重要注意事项** - 忽略状态栏、导航栏等
3. **图片资源处理** - 自动检测和引用方式
4. **路由管理指南** - 各平台的路由使用说明
5. **页面列表** - 每个页面的详细配置
6. **交互行为** - 元素的点击、滑动等事件
7. **图片替换** - 需要替换为图片的元素
8. **开发指引** - 最佳实践和注意事项

## 💡 使用技巧

1. **分组策略**：将同一页面的不同状态（默认、加载、空数据）分到一组
2. **选择器精确**：使用具体的 class 或 id，避免使用通用选择器
3. **描述清晰**：交互和图片替换的描述要具体明确
4. **多平台配置**：如果需要多平台，填写所有平台的源码路径
5. **图片路径**：使用项目资源目录的相对路径

## 🐛 常见问题

**Q: 为什么预览不显示？**
A: 请先上传 HTML 文件并选择要预览的文件

**Q: 选择器找不到元素？**
A: 检查选择器语法是否正确，或在浏览器 DevTools 中验证

**Q: 如何修改已创建的分组？**
A: 点击分组名称右侧的编辑按钮

**Q: 提示词中的源码路径显示"待创建"？**
A: 在分组配置中填写对应平台的源码路径

## 📄 License

MIT
